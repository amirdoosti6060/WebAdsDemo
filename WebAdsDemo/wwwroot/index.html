<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Web ADS Demo application</title>
    <style>
    </style>
</head>
<body>
    <h1>Web live ADS demo</h1>
    <span>Counter: <input type="number" id="counter" /></span>
    <input type="button" value="Read" onclick="onRead()" /> &nbsp;
    <input type="button" value="Write" onclick="onWrite()" />
    <br />
    <br />

    <span>Start/Stop <input id="chkStartStop" type="checkbox" value="1" onchange="onStartStop()" /> </span>
    <br />
    <p>Status: <span id="lblStatus">OFF</span> </p>

    <br />
    <p id="messageBox"></p>

    <script>
        const wsUri = "ws://localhost:5220/"
        const webSocket = new WebSocket(wsUri);

        webSocket.onopen = (e) => {
            writeToScreen("CONNECTED");
            doSend("WebSocket rocks");
        };

        webSocket.onclose = (e) => {
            writeToScreen("DISCONNECTED");
        };

        webSocket.onmessage = (e) => {
            writeToScreen(`RESPONSE: ${e.data}`);
        };

        webSocket.onerror = (e) => {
            writeToScreen(`<span class="error">ERROR:</span> ${e.data}`);
        };

        function writeToScreen(message) {
            console.log(message);
            var element = document.getElementById("messageBox");
            element.innerText = message;
        }

        function doSend(message) {
            writeToScreen(`SENT: ${message}`);
            webSocket.send(message);
        }

        function onRead() {
        }

        function onWrite() {
            doSend("From Client");
        }

        function onStartStop() {
            var checkBox = document.getElementById("chkStartStop");
            var checked = checkBox.checked;

            showStatus(checked);
        }

        function showStatus(status) {
            var element = document.getElementById("lblStatus");
            if (status)
                element.innerText = "ON";
            else
                element.innerText = "OFF";
        }
    </script>
</body>
</html>